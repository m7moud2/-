<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبار علوم الحديث الشامل المطور</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.2rem;
            color: #7f8c8d;
            margin-bottom: 20px;
        }
        
        .quiz-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            min-height: 500px;
        }
        
        .start-screen {
            text-align: center;
        }
        
        .quiz-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .info-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .info-card:hover {
            transform: translateY(-5px);
        }
        
        .info-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }
        
        .info-card p {
            font-size: 1.1rem;
        }
        
        .btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .btn-primary { background: linear-gradient(45deg, #3498db, #2980b9); }
        .btn-success { background: linear-gradient(45deg, #27ae60, #2ecc71); }
        .btn-warning { background: linear-gradient(45deg, #f39c12, #e67e22); }
        .btn-purple { background: linear-gradient(45deg, #9b59b6, #8e44ad); }
        
        .question-container {
            display: none;
        }
        
        .question-header {
            background: linear-gradient(45deg, #3498db, #2980b9);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .question-progress {
            background: rgba(255, 255, 255, 0.3);
            height: 10px;
            border-radius: 5px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            background: white;
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s ease;
        }
        
        .question-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
        }
        
        .category-badge {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 15px;
            display: inline-block;
        }
        
        .question-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .option {
            background: white;
            margin: 10px 0;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-size: 1.1rem;
        }
        
        .option:hover {
            background: #3498db;
            color: white;
            transform: translateX(5px);
            border-color: #2980b9;
        }
        
        .option.correct {
            background: #27ae60 !important;
            color: white !important;
            border-color: #2ecc71 !important;
        }
        
        .option.wrong {
            background: #e74c3c !important;
            color: white !important;
            border-color: #c0392b !important;
        }
        
        .option.disabled {
            pointer-events: none;
            opacity: 0.7;
        }
        
        .results-container {
            display: none;
            text-align: center;
        }
        
        .score-display {
            padding: 30px;
            border-radius: 20px;
            margin: 20px 0;
            color: white;
            font-size: 1.5rem;
        }
        
        .grade-excellent { background: linear-gradient(135deg, #27ae60, #2ecc71); }
        .grade-very-good { background: linear-gradient(135deg, #f39c12, #e67e22); }
        .grade-good { background: linear-gradient(135deg, #3498db, #2980b9); }
        .grade-fair { background: linear-gradient(135deg, #9b59b6, #8e44ad); }
        .grade-weak { background: linear-gradient(135deg, #e74c3c, #c0392b); }
        
        .results-details {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .result-item {
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            border-left: 4px solid;
        }
        
        .result-correct {
            background: #d5f4e6;
            border-color: #27ae60;
        }
        
        .result-wrong {
            background: #fdeaea;
            border-color: #e74c3c;
        }
        
        .recommendations {
            background: linear-gradient(135deg, #1abc9c, #16a085);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .timer {
            background: linear-gradient(45deg, #e67e22, #d35400);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .author-section {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 30px;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            display: block;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .quiz-info {
                grid-template-columns: 1fr;
            }
            
            .question-text {
                font-size: 1.1rem;
            }
            
            .option {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🧠 اختبار علوم الحديث الشامل المطور</h1>
            <p>اختبر معرفتك في علوم الحديث مع 57 سؤال متنوع وتقييم شامل ونتائج مفصلة</p>
        </div>

        <div class="quiz-container">
            <!-- شاشة البداية -->
            <div class="start-screen" id="startScreen">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">مرحباً بك في الاختبار الشامل المطور</h2>
                
                <div class="quiz-info">
                    <div class="info-card">
                        <h3>📊 عدد الأسئلة</h3>
                        <p>57 سؤال متنوع</p>
                    </div>
                    <div class="info-card">
                        <h3>⏱️ الوقت المقترح</h3>
                        <p>50 دقيقة</p>
                    </div>
                    <div class="info-card">
                        <h3>📚 المواضيع</h3>
                        <p>جميع أنواع الحديث المفصلة</p>
                    </div>
                    <div class="info-card">
                        <h3>🎯 التقييم</h3>
                        <p>تقييم متدرج مع توصيات تفصيلية</p>
                    </div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h3 style="color: #2c3e50; margin-bottom: 15px;">المواضيع المشمولة في الاختبار المطور:</h3>
                    <div style="display: flex; flex-wrap: wrap; justify-content: center; gap: 10px;">
                        <span class="category-badge">الحديث الضعيف</span>
                        <span class="category-badge">الحديث المرسل</span>
                        <span class="category-badge">الحديث المنقطع</span>
                        <span class="category-badge">الحديث المعضل</span>
                        <span class="category-badge">الحديث المعنعن</span>
                        <span class="category-badge">التدليس</span>
                        <span class="category-badge">الحديث الشاذ</span>
                        <span class="category-badge">الحديث المنكر</span>
                        <span class="category-badge">الحديث المتروك</span>
                        <span class="category-badge">الحديث المعلل</span>
                        <span class="category-badge">الحديث المضطرب</span>
                        <span class="category-badge">الحديث المدرج</span>
                        <span class="category-badge">الحديث الموضوع</span>
                        <span class="category-badge">الحديث المقلوب</span>
                        <span class="category-badge">الحديث المصحف</span>
                        <span class="category-badge">الحديث المؤنن</span>
                        <span class="category-badge">الحديث المعلق</span>
                        <span class="category-badge">أقوال العلماء</span>
                        <span class="category-badge">ترتيب أنواع الضعف</span>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="startQuiz()">🚀 ابدأ الاختبار المطور</button>
                <button class="btn btn-warning" onclick="showInstructions()">📋 التعليمات</button>
            </div>

            <!-- حاوية الأسئلة -->
            <div class="question-container" id="questionContainer">
                <div class="question-header">
                    <div class="timer" id="timer">⏱️ الوقت: 00:00</div>
                    <h3>السؤال <span id="questionNumber">1</span> من 57</h3>
                    <div class="question-progress">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
                
                <div class="question-card" id="questionCard">
                    <div class="category-badge" id="categoryBadge"></div>
                    <div class="question-text" id="questionText"></div>
                    <div id="optionsContainer"></div>
                </div>
                
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-success" id="nextBtn" onclick="nextQuestion()" style="display: none;">
                        التالي ➡️
                    </button>
                    <button class="btn btn-purple" id="finishBtn" onclick="finishQuiz()" style="display: none;">
                        إنهاء الاختبار 🏁
                    </button>
                </div>
            </div>

            <!-- نتائج الاختبار -->
            <div class="results-container" id="resultsContainer">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">🎉 نتائج الاختبار المطور</h2>
                
                <div class="score-display" id="scoreDisplay">
                    <div style="font-size: 3rem; margin-bottom: 10px;" id="gradeEmoji"></div>
                    <div style="font-size: 2.5rem; font-weight: bold;" id="scorePercentage"></div>
                    <div style="font-size: 1.3rem;" id="scoreText"></div>
                    <div style="font-size: 1.5rem; margin-top: 10px;" id="gradeText"></div>
                </div>
                
                <div class="stats-grid" id="statsGrid"></div>
                
                <div class="results-details" id="resultsDetails"></div>
                
                <div class="recommendations" id="recommendations"></div>
                
                <div style="margin: 20px 0;">
                    <button class="btn btn-primary" onclick="restartQuiz()">🔄 إعادة الاختبار</button>
                    <button class="btn btn-success" onclick="downloadResults()">📄 تحميل النتائج</button>
                    <button class="btn btn-warning" onclick="shareResults()">📤 مشاركة النتيجة</button>
                </div>
            </div>
        </div>

        <!-- معلومات الكاتب -->
        <div class="author-section">
            <h3>✍️ إعداد الاختبار المطور</h3>
            <p style="font-size: 1.2rem; margin: 10px 0;">أخوكم محمود عبدالقوي</p>
            <p style="margin: 5px 0;">مع الاستفادة من ملخص الطالب محمد شمس الدين</p>
            <p>🤲 لا تنسونا من دعائكم</p>
            <p style="margin-top: 15px; font-weight: bold;">🌟 بالتوفيق للجميع 🌟</p>
        </div>
    </div>

    <script>
        // بيانات الاختبار المطور
        const quizData = [
            // الأسئلة الأصلية المحسنة
            {
                question: "ما تعريف الحديث الضعيف؟",
                options: [
                    "ما لم يجمع صفة الصحيح أو الحسن",
                    "ما كان راويه مجهولاً",
                    "ما انقطع سنده",
                    "ما خالف القرآن"
                ],
                correct: 0,
                category: "الحديث الضعيف"
            },
            {
                question: "كم عدد شروط العمل بالحديث الضعيف عند شيخ الإسلام؟",
                options: ["شرطان", "ثلاثة شروط", "أربعة شروط", "خمسة شروط"],
                correct: 1,
                category: "الحديث الضعيف"
            },
            {
                question: "ما هو الرأي الراجح في العمل بالحديث الضعيف؟",
                options: [
                    "يعمل به مطلقاً كما قال أحمد",
                    "لا يجوز العمل به مطلقاً",
                    "يعمل به بثلاثة شروط عند شيخ الإسلام",
                    "يعمل به في جميع الأحكام"
                ],
                correct: 2,
                category: "الحديث الضعيف"
            },
            {
                question: "ما حكم العمل بالحديث الضعيف عند ابن العربي؟",
                options: [
                    "يعمل به مطلقاً",
                    "لا يجوز العمل به مطلقاً",
                    "يعمل به بشروط",
                    "يعمل به في الفضائل فقط"
                ],
                correct: 1,
                category: "الحديث الضعيف"
            },
            {
                question: "ما تعريف الحديث المرسل؟",
                options: [
                    "ما رفعه التابعي إلى رسول الله بشرط أن يكون لم يسمعه من النبي",
                    "ما سقط من إسناده راو واحد",
                    "ما روي بصيغة عن",
                    "ما اختلف في متنه"
                ],
                correct: 0,
                category: "الحديث المرسل"
            },
            {
                question: "أصح المرسلات عند العلماء؟",
                options: [
                    "مراسيل الحسن البصري",
                    "مراسيل سعيد بن المسيب",
                    "مراسيل عطاء بن أبي رباح",
                    "مراسيل مجاهد"
                ],
                correct: 1,
                category: "الحديث المرسل"
            },
            {
                question: "كم شرطاً لقبول المرسل عند الإمام الشافعي؟",
                options: [
                    "أربعة شروط في الراوي وأربعة في المتن",
                    "ثلاثة شروط في الراوي وأربعة في المتن",
                    "خمسة شروط في الراوي وثلاثة في المتن",
                    "شرطان في الراوي وخمسة في المتن"
                ],
                correct: 1,
                category: "الحديث المرسل"
            },
            {
                question: "ما حكم مراسيل الصحابة؟",
                options: [
                    "لا يحتج بها مطلقاً",
                    "يحتج بها لأنهم كلهم عدول - وهذا الراجح",
                    "يحتج بها في الفضائل فقط",
                    "حكمها كمراسيل التابعين"
                ],
                correct: 1,
                category: "الحديث المرسل"
            },
            {
                question: "كم قولاً تلخص في الاحتجاج بالمرسل؟",
                options: ["8 أقوال", "10 أقوال", "12 قولاً", "15 قولاً"],
                correct: 1,
                category: "الحديث المرسل"
            },
            {
                question: "ما الفرق بين المنقطع والمقطوع؟",
                options: [
                    "لا فرق بينهما",
                    "المنقطع من صفات الإسناد والمقطوع من صفات المتن",
                    "المنقطع أشد ضعفاً",
                    "المقطوع من صفات الإسناد"
                ],
                correct: 1,
                category: "الحديث المنقطع"
            },
            {
                question: "كيف يُعرف الانقطاع؟",
                options: [
                    "بأمرين: التخريج واستحالة المعاصرة",
                    "بثلاثة أمور: التخريج واستحالة المعاصرة ونص النقاد",
                    "بالتخريج فقط",
                    "بنص النقاد فقط"
                ],
                correct: 1,
                category: "الحديث المنقطع"
            },
            {
                question: "كم حديثاً منقطعاً في صحيح مسلم تقريباً؟",
                options: ["بضعة أحاديث", "بضعة 10 حديثاً", "أكثر من 20", "لا يوجد"],
                correct: 1,
                category: "الحديث المنقطع"
            },
            {
                question: "ما تعريف الحديث المعضل؟",
                options: [
                    "ما سقط من إسناده راو واحد",
                    "ما سقط من إسناده اثنان فأكثر بشرط التوالي",
                    "ما حذف من أول الإسناد",
                    "ما روي بصيغة عن"
                ],
                correct: 1,
                category: "الحديث المعضل"
            },
            {
                question: "متى يجتمع الإعضال مع الإرسال؟",
                options: [
                    "إذا سقط من أول الإسناد راويان مع التوالي",
                    "إذا سقط من آخر الإسناد راويان أو أكثر مع التوالي",
                    "إذا سقط من وسط الإسناد راويان مع التوالي",
                    "لا يجتمعان أبداً"
                ],
                correct: 1,
                category: "الحديث المعضل"
            },
            {
                question: "من ألف كتاباً في وصل ما في الموطأ من المرسل والمنقطع والمعضل؟",
                options: [
                    "ابن عبد البر",
                    "الإمام مالك",
                    "ابن حجر",
                    "النووي"
                ],
                correct: 0,
                category: "الحديث المعضل"
            },
            {
                question: "ما هي شروط قبول المعنعن عند البخاري؟",
                options: [
                    "عدم التدليس والمعاصرة فقط",
                    "عدم التدليس والمعاصرة وثبوت اللقاء",
                    "عدم التدليس وطول الصحبة",
                    "المعاصرة فقط"
                ],
                correct: 1,
                category: "الحديث المعنعن"
            },
            {
                question: "ما موقف الإمام مسلم من شرط ثبوت اللقاء؟",
                options: [
                    "يوافق البخاري في اشتراطه",
                    "يكتفي بالمعاصرة واشتد نكيره على البخاري",
                    "يشترط طول الصحبة",
                    "لا يشترط شيئاً"
                ],
                correct: 1,
                category: "الحديث المعنعن"
            },
            {
                question: "كم رأياً في حكم المعنعن؟",
                options: ["3 آراء", "4 آراء", "5 آراء", "6 آراء"],
                correct: 1,
                category: "الحديث المعنعن"
            },
            {
                question: "ما تعريف الحديث المؤنن؟",
                options: [
                    "ما قيل في سنده: حدثنا فلان أن فلاناً",
                    "ما روي بصيغة عن",
                    "ما انقطع سنده",
                    "ما حذف من أوله"
                ],
                correct: 0,
                category: "الحديث المؤنن"
            },
            {
                question: "ما حكم الحديث المؤنن عند الجمهور؟",
                options: [
                    "يقبل مطلقاً",
                    "يرد مطلقاً",
                    "يقبل إذا كان الراوي معروفاً بالتحديث والسماع",
                    "حكمه كالمعنعن"
                ],
                correct: 2,
                category: "الحديث المؤنن"
            },
            {
                question: "ما تعريف الحديث المعلق؟",
                options: [
                    "ما سقط من وسط إسناده راو",
                    "ما حذف من مبدأ سنده واحد فأكثر على التوالي",
                    "ما انقطع في آخره",
                    "ما روي بصيغة غير جازمة"
                ],
                correct: 1,
                category: "الحديث المعلق"
            },
            {
                question: "ما هي صيغ التعليق الجازمة؟",
                options: [
                    "يروى ويقال ويذكر",
                    "قال وفعل وأمر ونهى وذكر وحكى",
                    "حُكي وذُكر ونُقل",
                    "بلغنا وجاء وورد"
                ],
                correct: 1,
                category: "الحديث المعلق"
            },
            {
                question: "من القائل: 'التدليس أخو الكذب'؟",
                options: [
                    "الإمام أحمد",
                    "شعبة بن الحجاج",
                    "الإمام مالك",
                    "الإمام الشافعي"
                ],
                correct: 1,
                category: "التدليس"
            },
            {
                question: "كم قسماً للتدليس عند الحاكم؟",
                options: ["أربعة أقسام", "خمسة أقسام", "ستة أقسام", "سبعة أقسام"],
                correct: 2,
                category: "التدليس"
            },
            {
                question: "ما هو تدليس التسوية؟",
                options: [
                    "أن يروي عمن عاصره ما لم يسمعه منه",
                    "أن يسقط غير شيخه لضعفه أو صغره",
                    "أن يغير اسم شيخه",
                    "أن يروي بصيغة موهمة"
                ],
                correct: 1,
                category: "التدليس"
            },
            {
                question: "ما هو تدليس العطف؟",
                options: [
                    "أن يعطف شيخاً على آخر لم يسمع منه",
                    "أن يغير اسم الشيخ",
                    "أن يسقط راوياً ضعيفاً",
                    "أن يروي بصيغة مبهمة"
                ],
                correct: 0,
                category: "التدليس"
            },
            {
                question: "من أكثر المحدثين تدليساً حسب الحاكم؟",
                options: [
                    "أهل المدينة",
                    "أهل الكوفة",
                    "أهل بغداد",
                    "أهل البصرة"
                ],
                correct: 1,
                category: "التدليس"
            },
            {
                question: "من أول من تكلم في الحديث الشاذ؟",
                options: ["البخاري", "الشافعي", "ابن المديني", "الحاكم"],
                correct: 1,
                category: "الحديث الشاذ"
            },
            {
                question: "ما الذي يقابل الحديث الشاذ؟",
                options: ["المعروف", "المحفوظ", "المعل", "المقبول"],
                correct: 1,
                category: "الحديث الشاذ"
            },
            {
                question: "ما تعريف الشاذ عند الخليلي؟",
                options: [
                    "ما رواه الثقة مخالفاً للناس",
                    "ما ليس له إلا إسناد واحد يشذ به ثقة أو غيره",
                    "ما انفرد به ثقة وليس له أصل بمتابع",
                    "ما رواه الضعيف مخالفاً للثقة"
                ],
                correct: 1,
                category: "الحديث الشاذ"
            },
            {
                question: "ما تعريف الحديث المنكر؟",
                options: [
                    "ما رواه الثقة مخالفاً للأوثق",
                    "ما رواه راو ضعيف مخالفاً لما رواه الثقة",
                    "ما فيه علة خفية",
                    "ما انقطع سنده"
                ],
                correct: 1,
                category: "الحديث المنكر"
            },
            {
                question: "كم قسماً للحديث المنكر؟",
                options: [
                    "ثلاثة أقسام",
                    "قسمان: المفرد المخالف والفرد الذي ليس في روايته إتقان",
                    "أربعة أقسام",
                    "قسم واحد فقط"
                ],
                correct: 1,
                category: "الحديث المنكر"
            },
            {
                question: "ما العلاقة بين الشاذ والمنكر؟",
                options: [
                    "لا علاقة بينهما",
                    "بينهما عموم وخصوص من وجه",
                    "الشاذ أعم من المنكر",
                    "المنكر أعم من الشاذ"
                ],
                correct: 1,
                category: "الحديث المنكر"
            },
            {
                question: "ما تعريف الحديث المتروك؟",
                options: [
                    "ما رواه ضعيف مخالفاً للثقة",
                    "ما في إسناده راو متهم بالكذب",
                    "ما انقطع سنده",
                    "ما اضطرب متنه"
                ],
                correct: 1,
                category: "الحديث المتروك"
            },
            {
                question: "كم صفة للحديث المتروك ذكرها المصنف؟",
                options: ["3 صفات", "4 صفات", "5 صفات", "6 صفات"],
                correct: 2,
                category: "الحديث المتروك"
            },
            {
                question: "بم تُدرك العلة في الحديث؟",
                options: [
                    "بالنظر في المتن فقط",
                    "بتفرد الراوي ومخالفة غيره له مع قرائن",
                    "بضعف الراوي",
                    "بانقطاع السند"
                ],
                correct: 1,
                category: "الحديث المعلل"
            },
            {
                question: "كم جنساً للحديث المعلل عند الحاكم؟",
                options: ["ثمانية أجناس", "تسعة أجناس", "عشرة أجناس", "اثنا عشر جنساً"],
                correct: 2,
                category: "الحديث المعلل"
            },
            {
                question: "ما قال ابن مهدي في إدراك العلة؟",
                options: [
                    "تدرك بالقياس",
                    "تدرك بالإلهام",
                    "تدرك بالتخريج",
                    "تدرك بالمقارنة"
                ],
                correct: 1,
                category: "الحديث المعلل"
            },
            {
                question: "أين تكون العلة أكثر؟",
                options: [
                    "في المتن",
                    "في السند",
                    "في كليهما بالتساوي",
                    "في الراوي"
                ],
                correct: 1,
                category: "الحديث المعلل"
            },
            {
                question: "لماذا كان الحديث المضطرب ضعيفاً؟",
                options: [
                    "لانقطاع سنده",
                    "لإشعاره بعدم الضبط من رواته",
                    "لضعف راويه",
                    "لمخالفته القرآن"
                ],
                correct: 1,
                category: "الحديث المضطرب"
            },
            {
                question: "كم قسماً للاضطراب؟",
                options: [
                    "قسمان: اضطراب السند واضطراب المتن",
                    "ثلاثة أقسام",
                    "أربعة أقسام",
                    "قسم واحد فقط"
                ],
                correct: 0,
                category: "الحديث المضطرب"
            },
            {
                question: "متى لا يسمى الحديث مضطرباً؟",
                options: [
                    "إذا تساوت الروايات",
                    "إذا ترجحت إحدى الروايات",
                    "إذا كان في السند فقط",
                    "إذا كان من راو واحد"
                ],
                correct: 1,
                category: "الحديث المضطرب"
            },
            {
                question: "ما حكم الإدراج في الحديث؟",
                options: [
                    "مكروه",
                    "جائز للضرورة",
                    "حرام بإجماع أهل الحديث والفقه",
                    "مباح"
                ],
                correct: 2,
                category: "الحديث المدرج"
            },
            {
                question: "كم قسماً للحديث المدرج؟",
                options: [
                    "قسمان",
                    "ثلاثة أقسام",
                    "أربعة أقسام",
                    "خمسة أقسام"
                ],
                correct: 1,
                category: "الحديث المدرج"
            },
            {
                question: "ما اسم كتاب الخطيب في الحديث المدرج؟",
                options: [
                    "الكفاية",
                    "شفى وكفى",
                    "تاريخ بغداد",
                    "الجامع لأخلاق الراوي"
                ],
                correct: 1,
                category: "الحديث المدرج"
            },
            {
                question: "كيف يكشف الإدراج؟",
                options: [
                    "بطريقة واحدة فقط",
                    "بطريقتين",
                    "بثلاث طرق",
                    "بأربع طرق"
                ],
                correct: 3,
                category: "الحديث المدرج"
            },
            {
                question: "ما الفرق بين المصحف والمحرف؟",
                options: [
                    "لا فرق بينهما",
                    "المصحف ما غُير فيه النقط والمحرف ما غُير فيه الشكل",
                    "المحرف أشد من المصحف",
                    "المصحف في السند والمحرف في المتن"
                ],
                correct: 1,
                category: "الحديث المصحف"
            },
            {
                question: "كم قسماً للتصحيف؟",
                options: ["3 أقسام", "4 أقسام", "5 أقسام", "6 أقسام"],
                correct: 1,
                category: "الحديث المصحف"
            },
            {
                question: "كم عدد الكذابين المعروفين عند النسائي؟",
                options: ["ثلاثة", "أربعة", "خمسة", "ستة"],
                correct: 1,
                category: "الحديث الموضوع"
            },
            {
                question: "من هم الكذابون الأربعة عند النسائي؟",
                options: [
                    "ابن أبي يحيى والواقدي ومقاتل ومحمد بن سعيد المصلوب",
                    "الواقدي وبقية والوليد بن مسلم وابن لهيعة",
                    "مقاتل وابن أبي يحيى والكديمي والواقدي",
                    "محمد بن سعيد وبقية وعبد الكريم بن أبي العوجاء والواقدي"
                ],
                correct: 0,
                category: "الحديث الموضوع"
            },
            {
                question: "ما حكم العمل بالحديث الموضوع؟",
                options: [
                    "جائز في الفضائل",
                    "مكروه",
                    "حرام بالإجماع",
                    "جائز مع التنبيه"
                ],
                correct: 2,
                category: "الحديث الموضوع"
            },
            {
                question: "كم قسماً للوضاعين؟",
                options: [
                    "خمسة أقسام",
                    "ستة أقسام", 
                    "سبعة أقسام",
                    "ثمانية أقسام"
                ],
                correct: 2,
                category: "الحديث الموضوع"
            },
            {
                question: "كيف يُعرف الوضع في الحديث؟",
                options: [
                    "بطريقة واحدة",
                    "بطريقتين",
                    "بثلاث طرق أو ما يتنزل منزلتها",
                    "بالاجتهاد فقط"
                ],
                correct: 2,
                category: "الحديث الموضوع"
            },
            {
                question: "متى يكون القلب جائزاً في الحديث المقلوب؟",
                options: [
                    "إذا كان سهواً",
                    "إذا كان عمداً للاختبار",
                    "إذا كان للإغراب",
                    "لا يجوز مطلقاً"
                ],
                correct: 1,
                category: "الحديث المقلوب"
            },
            {
                question: "كم قسماً للحديث المقلوب؟",
                options: [
                    "قسم واحد",
                    "قسمان: تغيير راو بآخر أو قلب الإسناد والمتن",
                    "ثلاثة أقسام",
                    "أربعة أقسام"
                ],
                correct: 1,
                category: "الحديث المقلوب"
            },
            {
                question: "ما ترتيب الضعيف حسب شدة ضعفه عند الزركشي؟",
                options: [
                    "الموضوع ثم المدرج ثم المقلوب ثم المنكر",
                    "المنكر ثم الموضوع ثم المدرج ثم المقلوب",
                    "المدرج ثم الموضوع ثم المنكر ثم المقلوب",
                    "المقلوب ثم المنكر ثم المدرج ثم الموضوع"
                ],
                correct: 0,
                category: "ترتيب الضعف"
            },
            {
                question: "ما أشد أنواع الحديث الضعيف؟",
                options: ["المنكر", "الموضوع", "المدرج", "المقلوب"],
                correct: 1,
                category: "ترتيب الضعف"
            }
        ];

        // متغيرات الاختبار
        let currentQuestion = 0;
        let score = 0;
        let answers = [];
        let startTime = null;
        let timerInterval = null;

        function startQuiz() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('questionContainer').style.display = 'block';
            
            currentQuestion = 0;
            score = 0;
            answers = [];
            startTime = Date.now();
            
            startTimer();
            showQuestion();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                
                document.getElementById('timer').textContent = 
                    `⏱️ الوقت: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function showQuestion() {
            const question = quizData[currentQuestion];
            const progress = ((currentQuestion + 1) / quizData.length) * 100;
            
            document.getElementById('questionNumber').textContent = currentQuestion + 1;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('categoryBadge').textContent = question.category;
            document.getElementById('questionText').textContent = question.question;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionDiv.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(optionDiv);
            });
            
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('finishBtn').style.display = 'none';
        }

        function selectAnswer(selectedIndex) {
            const question = quizData[currentQuestion];
            const options = document.querySelectorAll('.option');
            
            // تعطيل جميع الخيارات
            options.forEach((option, index) => {
                option.classList.add('disabled');
                
                if (index === question.correct) {
                    option.classList.add('correct');
                    option.innerHTML = '✅ ' + option.innerHTML;
                } else if (index === selectedIndex && index !== question.correct) {
                    option.classList.add('wrong');
                    option.innerHTML = '❌ ' + option.innerHTML;
                }
            });
            
            // حفظ الإجابة
            const isCorrect = selectedIndex === question.correct;
            answers.push({
                question: question.question,
                category: question.category,
                selectedAnswer: question.options[selectedIndex],
                correctAnswer: question.options[question.correct],
                isCorrect: isCorrect
            });
            
            if (isCorrect) {
                score++;
            }
            
            // إظهار أزرار التنقل
            if (currentQuestion < quizData.length - 1) {
                document.getElementById('nextBtn').style.display = 'inline-block';
            } else {
                document.getElementById('finishBtn').style.display = 'inline-block';
            }
        }

        function nextQuestion() {
            currentQuestion++;
            showQuestion();
        }

        function finishQuiz() {
            clearInterval(timerInterval);
            
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'block';
            
            saveResults();
            showResults();
        }

        function showResults() {
            const percentage = Math.round((score / quizData.length) * 100);
            const grade = getGrade(percentage);
            const endTime = Date.now();
            const totalTime = Math.floor((endTime - startTime) / 1000);
            
            document.getElementById('gradeEmoji').textContent = grade.emoji;
            document.getElementById('scorePercentage').textContent = `${percentage}%`;
            document.getElementById('scoreText').textContent = `${score} من ${quizData.length} إجابة صحيحة`;
            document.getElementById('gradeText').textContent = grade.text;
            
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.className = `score-display ${grade.class}`;
            
            // إحصائيات
            showStatistics(totalTime, percentage);
            
            // تفاصيل النتائج
            showDetailedResults();
            
            // التوصيات
            showRecommendations(percentage);
        }

        function getGrade(percentage) {
            if (percentage >= 90) return { 
                text: "ممتاز جداً", 
                emoji: "🌟", 
                class: "grade-excellent" 
            };
            if (percentage >= 80) return { 
                text: "ممتاز", 
                emoji: "⭐", 
                class: "grade-very-good" 
            };
            if (percentage >= 70) return { 
                text: "جيد جداً", 
                emoji: "👍", 
                class: "grade-good" 
            };
            if (percentage >= 60) return { 
                text: "جيد", 
                emoji: "👌", 
                class: "grade-fair" 
            };
            if (percentage >= 50) return { 
                text: "مقبول", 
                emoji: "😐", 
                class: "grade-fair" 
            };
            return { 
                text: "يحتاج تحسين", 
                emoji: "📚", 
                class: "grade-weak" 
            };
        }

        function showStatistics(totalTime, percentage) {
            const minutes = Math.floor(totalTime / 60);
            const seconds = totalTime % 60;
            
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = `
                <div class="stat-card">
                    <span class="stat-number">${percentage}%</span>
                    <span>النتيجة النهائية</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${score}</span>
                    <span>إجابات صحيحة</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${quizData.length - score}</span>
                    <span>إجابات خاطئة</span>
                </div>
                <div class="stat-card">
                    <span class="stat-number">${minutes}:${seconds.toString().padStart(2, '0')}</span>
                    <span>الوقت المستغرق</span>
                </div>
            `;
        }

        function showDetailedResults() {
            const resultsDetails = document.getElementById('resultsDetails');
            let html = '<h4 style="margin-bottom: 15px; color: #2c3e50;">📊 تفاصيل الإجابات:</h4>';
            
            answers.forEach((answer, index) => {
                const resultClass = answer.isCorrect ? 'result-correct' : 'result-wrong';
                const icon = answer.isCorrect ? '✅' : '❌';
                
                html += `
                    <div class="result-item ${resultClass}">
                        <div style="font-weight: bold; margin-bottom: 8px;">
                            ${icon} السؤال ${index + 1}: ${answer.category}
                        </div>
                        <div style="margin-bottom: 5px; font-size: 0.9rem;">
                            <strong>إجابتك:</strong> ${answer.selectedAnswer}
                        </div>
                        ${!answer.isCorrect ? 
                            `<div style="color: #27ae60; font-size: 0.9rem;">
                                <strong>الإجابة الصحيحة:</strong> ${answer.correctAnswer}
                            </div>` : 
                            ''
                        }
                    </div>
                `;
            });
            
            resultsDetails.innerHTML = html;
        }

        function showRecommendations(percentage) {
            const recommendations = document.getElementById('recommendations');
            let html = '<h4 style="margin-bottom: 15px;">📈 توصيات للتحسين:</h4><ul style="text-align: right; list-style: none; padding: 0;">';
            
            if (percentage < 60) {
                html += '<li style="padding: 5px 0;">📖 راجع المفاهيم الأساسية مرة أخرى</li>';
                html += '<li style="padding: 5px 0;">🔄 أعد قراءة تعريفات أنواع الحديث</li>';
                html += '<li style="padding: 5px 0;">📝 اكتب ملخصات للنقاط المهمة</li>';
                html += '<li style="padding: 5px 0;">👨‍🏫 استعن بشرح المدرس للنقاط الصعبة</li>';
            }
            if (percentage < 75) {
                html += '<li style="padding: 5px 0;">📚 ركز على الفروق بين المصطلحات المتشابهة</li>';
                html += '<li style="padding: 5px 0;">🔍 راجع أمثلة كل نوع من أنواع الحديث</li>';
                html += '<li style="padding: 5px 0;">📋 اعمل جداول مقارنة بين الأنواع المختلفة</li>';
            }
            if (percentage >= 75 && percentage < 90) {
                html += '<li style="padding: 5px 0;">⭐ أداء جيد! ركز على النقاط الدقيقة</li>';
                html += '<li style="padding: 5px 0;">🎯 راجع أقوال العلماء وتفاصيلها</li>';
                html += '<li style="padding: 5px 0;">📖 ادرس الأمثلة التطبيقية أكثر</li>';
            }
            if (percentage >= 90) {
                html += '<li style="padding: 5px 0;">🌟 أداء ممتاز! أنت تتقن المادة</li>';
                html += '<li style="padding: 5px 0;">🚀 حاول تعليم زملائك ما تعلمته</li>';
                html += '<li style="padding: 5px 0;">📚 انتقل لدراسة مواضيع متقدمة</li>';
                html += '<li style="padding: 5px 0;">🏆 شارك في المناقشات العلمية</li>';
            }
            
            // تحليل الأخطاء حسب الفئة
            const errorCategories = {};
            answers.forEach(answer => {
                if (!answer.isCorrect) {
                    errorCategories[answer.category] = (errorCategories[answer.category] || 0) + 1;
                }
            });
            
            const sortedErrors = Object.entries(errorCategories)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 3);
            
            if (sortedErrors.length > 0) {
                html += '<li style="padding: 10px 0; color: #e74c3c; font-weight: bold;">🎯 المواضيع التي تحتاج تركيز أكثر:</li>';
                sortedErrors.forEach(([category, count]) => {
                    html += `<li style="padding: 3px 20px; color: #e74c3c;">• ${category} (${count} أخطاء)</li>`;
                });
            }
            
            html += '<li style="padding: 5px 0;">🕐 خذ استراحة ثم عاود المراجعة</li>';
            html += '<li style="padding: 5px 0;">🤝 ناقش الصعوبات مع الزملاء أو المدرس</li>';
            html += '<li style="padding: 5px 0;">🔄 أعد الاختبار بعد المراجعة للتأكد من التحسن</li>';
            html += '</ul>';
            
            recommendations.innerHTML = html;
        }

        function restartQuiz() {
            document.getElementById('resultsContainer').style.display = 'none';
            document.getElementById('startScreen').style.display = 'block';
            
            // إعادة تعيين المتغيرات
            currentQuestion = 0;
            score = 0;
            answers = [];
            startTime = null;
            
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // إيقاف التأثيرات
            stopCelebrationEffects();
        }

        function downloadResults() {
            const percentage = Math.round((score / quizData.length) * 100);
            const grade = getGrade(percentage);
            const totalTime = Math.floor((Date.now() - startTime) / 1000);
            const minutes = Math.floor(totalTime / 60);
            const seconds = totalTime % 60;
            
            let content = `
# 📊 نتائج اختبار علوم الحديث الشامل المطور

## 🎯 النتيجة النهائية
- **النسبة المئوية:** ${percentage}%
- **الدرجة:** ${grade.text} ${grade.emoji}
- **الإجابات الصحيحة:** ${score} من ${quizData.length}
- **الوقت المستغرق:** ${minutes}:${seconds.toString().padStart(2, '0')}
- **التاريخ:** ${new Date().toLocaleDateString('ar-SA')}

## 📋 تفاصيل الإجابات

`;

            answers.forEach((answer, index) => {
                const status = answer.isCorrect ? '✅ صحيح' : '❌ خطأ';
                content += `### السؤال ${index + 1}: ${answer.category}
- **الإجابة المختارة:** ${answer.selectedAnswer}
- **الإجابة الصحيحة:** ${answer.correctAnswer}
- **النتيجة:** ${status}

`;
            });

            content += `
---
**إعداد:** أخوكم محمود عبدالقوي
**مع الاستفادة من ملخص الطالب محمد شمس الدين**
**🤲 لا تنسونا من دعائكم**
`;

            const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `نتائج_اختبار_علوم_الحديث_المطور_${new Date().toLocaleDateString('ar-SA').replace(/\//g, '-')}.md`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function shareResults() {
            const percentage = Math.round((score / quizData.length) * 100);
            const grade = getGrade(percentage);
            
            const text = `🧠 نتيجتي في اختبار علوم الحديث الشامل المطور:
${grade.emoji} ${percentage}% - ${grade.text}
${score} من ${quizData.length} إجابة صحيحة

📚 اختبار شامل يغطي جميع أنواع الحديث بـ 40 سؤال متنوع
✍️ إعداد: محمود عبدالقوي
📖 بالاستفادة من ملخص: محمد شمس الدين

#علوم_الحديث #اختبار_شامل`;

            if (navigator.share) {
                navigator.share({
                    title: 'نتائج اختبار علوم الحديث المطور',
                    text: text
                });
            } else {
                navigator.clipboard.writeText(text).then(() => {
                    showSuccessMessage('تم نسخ النتيجة إلى الحافظة! 📋');
                }).catch(() => {
                    const newWindow = window.open('', '_blank');
                    newWindow.document.write(`
                        <html dir="rtl">
                        <head><title>مشاركة النتيجة</title></head>
                        <body style="font-family: Arial; padding: 20px; direction: rtl;">
                        <h2>انسخ النص التالي لمشاركة نتيجتك:</h2>
                        <textarea style="width: 100%; height: 200px; font-size: 14px;">${text}</textarea>
                        </body>
                        </html>
                    `);
                });
            }
        }

        function showInstructions() {
            alert(`📋 تعليمات الاختبار المطور:

🎯 الهدف: تقييم شامل لمعرفتك في علوم الحديث
📊 عدد الأسئلة: 57 سؤال متنوع ومفصل
⏱️ الوقت: مفتوح (الوقت المقترح: 50 دقيقة)

📚 المواضيع الجديدة المضافة:
• تفاصيل أعمق في كل نوع من أنواع الحديث
• أقوال العلماء ومذاهبهم
• الفروق الدقيقة بين المصطلحات
• أمثلة تطبيقية من كتب العلماء
• ترتيب أنواع الضعف
• تفاصيل التدليس وأقسامه

🎯 التقييم المطور:
• 90%+ ممتاز جداً 🌟 (مع تأثيرات احتفالية)
• 80-89% ممتاز ⭐
• 70-79% جيد جداً 👍
• 60-69% جيد 👌
• 50-59% مقبول 😐
• أقل من 50% يحتاج تحسين 📚

💡 نصائح للنجاح:
• اقرأ السؤال بعناية فائقة
• انتبه للفروق الدقيقة
• استذكر أقوال العلماء
• ركز على التفاصيل المهمة
• لا تتسرع في الإجابة

🎉 مميزات جديدة:
• تأثيرات احتفالية حسب النتيجة
• تحليل مفصل للأخطاء
• توصيات محددة للتحسين
• إحصائيات شاملة

بالتوفيق! 🍀`);
        }

        // حفظ النتائج في المتصفح
        function saveResults() {
            const results = {
                score: score,
                total: quizData.length,
                percentage: Math.round((score / quizData.length) * 100),
                date: new Date().toISOString(),
                answers: answers,
                timeSpent: Math.floor((Date.now() - startTime) / 1000)
            };
            
            localStorage.setItem('hadithQuizResultsEnhanced', JSON.stringify(results));
        }

        // التأثيرات الاحتفالية
        function showCelebrationEffects(percentage) {
            createConfetti();
            showSuccessMessage(getCelebrationMessage(percentage));
            
            // إضافة تأثيرات صوتية (محاكاة)
            if (percentage >= 90) {
                createFireworks();
                setTimeout(() => createStars(), 1000);
            } else if (percentage >= 80) {
                createBalloons();
            } else if (percentage >= 70) {
                createSparkles();
            }
        }

        function getCelebrationMessage(percentage) {
            if (percentage >= 95) {
                return "🎉 استثنائي! أنت عالم حديث حقيقي! 🌟";
            } else if (percentage >= 90) {
                return "🎊 ممتاز جداً! إتقان رائع لعلوم الحديث! ⭐";
            } else if (percentage >= 85) {
                return "🎈 ممتاز! مستوى متقدم في علوم الحديث! 👏";
            } else if (percentage >= 80) {
                return "🎯 أداء ممتاز! استمر في التميز! 🏆";
            } else if (percentage >= 75) {
                return "👍 جيد جداً! أنت على الطريق الصحيح! 📚";
            } else if (percentage >= 70) {
                return "👌 جيد! واصل المراجعة والتحسن! 💪";
            } else if (percentage >= 60) {
                return "😊 مقبول! مع المراجعة ستتحسن! 📖";
            } else {
                return "💪 لا تيأس! المراجعة والممارسة طريق النجاح! 🌱";
            }
        }

        function createConfetti() {
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.innerHTML = ['🎉', '🎊', '⭐', '🌟', '✨'][Math.floor(Math.random() * 5)];
                confetti.style.position = 'fixed';
                confetti.style.fontSize = '20px';
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.top = '-10px';
                confetti.style.zIndex = '9999';
                confetti.style.pointerEvents = 'none';
                confetti.style.animation = `fall ${Math.random() * 3 + 2}s linear forwards`;
                
                document.body.appendChild(confetti);
                
                setTimeout(() => {
                    confetti.remove();
                }, 5000);
            }
        }

        function createFireworks() {
            for (let i = 0; i < 20; i++) {
                const firework = document.createElement('div');
                firework.innerHTML = '💥';
                firework.style.position = 'fixed';
                firework.style.fontSize = '30px';
                firework.style.left = Math.random() * 100 + 'vw';
                firework.style.top = Math.random() * 50 + 'vh';
                firework.style.zIndex = '9999';
                firework.style.pointerEvents = 'none';
                firework.style.animation = `explode 2s ease-out forwards`;
                
                document.body.appendChild(firework);
                
                setTimeout(() => {
                    firework.remove();
                }, 2000);
            }
        }

        function createStars() {
            for (let i = 0; i < 30; i++) {
                const star = document.createElement('div');
                star.innerHTML = '⭐';
                star.style.position = 'fixed';
                star.style.fontSize = '25px';
                star.style.left = Math.random() * 100 + 'vw';
                star.style.top = Math.random() * 100 + 'vh';
                star.style.zIndex = '9999';
                star.style.pointerEvents = 'none';
                star.style.animation = `twinkle 3s ease-in-out infinite`;
                
                document.body.appendChild(star);
                
                setTimeout(() => {
                    star.remove();
                }, 6000);
            }
        }

        function createBalloons() {
            for (let i = 0; i < 15; i++) {
                const balloon = document.createElement('div');
                balloon.innerHTML = '🎈';
                balloon.style.position = 'fixed';
                balloon.style.fontSize = '25px';
                balloon.style.left = Math.random() * 100 + 'vw';
                balloon.style.bottom = '-50px';
                balloon.style.zIndex = '9999';
                balloon.style.pointerEvents = 'none';
                balloon.style.animation = `float ${Math.random() * 2 + 3}s ease-out forwards`;
                
                document.body.appendChild(balloon);
                
                setTimeout(() => {
                    balloon.remove();
                }, 5000);
            }
        }

        function createSparkles() {
            for (let i = 0; i < 25; i++) {
                const sparkle = document.createElement('div');
                sparkle.innerHTML = '✨';
                sparkle.style.position = 'fixed';
                sparkle.style.fontSize = '20px';
                sparkle.style.left = Math.random() * 100 + 'vw';
                sparkle.style.top = Math.random() * 100 + 'vh';
                sparkle.style.zIndex = '9999';
                sparkle.style.pointerEvents = 'none';
                sparkle.style.animation = `sparkle 2s ease-in-out forwards`;
                
                document.body.appendChild(sparkle);
                
                setTimeout(() => {
                    sparkle.remove();
                }, 2000);
            }
        }

        function showSuccessMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.innerHTML = message;
            messageDiv.style.position = 'fixed';
            messageDiv.style.top = '20px';
            messageDiv.style.left = '50%';
            messageDiv.style.transform = 'translateX(-50%)';
            messageDiv.style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
            messageDiv.style.color = 'white';
            messageDiv.style.padding = '15px 30px';
            messageDiv.style.borderRadius = '25px';
            messageDiv.style.fontSize = '18px';
            messageDiv.style.fontWeight = 'bold';
            messageDiv.style.zIndex = '10000';
            messageDiv.style.boxShadow = '0 10px 30px rgba(0,0,0,0.3)';
            messageDiv.style.animation = 'slideDown 0.5s ease-out forwards';
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.style.animation = 'slideUp 0.5s ease-in forwards';
                setTimeout(() => {
                    messageDiv.remove();
                }, 500);
            }, 3000);
        }

        function stopCelebrationEffects() {
            // إزالة جميع التأثيرات
            const effects = document.querySelectorAll('[style*="animation"]');
            effects.forEach(effect => {
                if (effect.innerHTML.match(/[🎉🎊⭐🌟✨💥🎈]/)) {
                    effect.remove();
                }
            });
        }

        // تحديث دالة showResults لتشمل التأثيرات
        function showResults() {
            const percentage = Math.round((score / quizData.length) * 100);
            const grade = getGrade(percentage);
            const endTime = Date.now();
            const totalTime = Math.floor((endTime - startTime) / 1000);
            
            document.getElementById('gradeEmoji').textContent = grade.emoji;
            document.getElementById('scorePercentage').textContent = `${percentage}%`;
            document.getElementById('scoreText').textContent = `${score} من ${quizData.length} إجابة صحيحة`;
            document.getElementById('gradeText').textContent = grade.text;
            
            const scoreDisplay = document.getElementById('scoreDisplay');
            scoreDisplay.className = `score-display ${grade.class}`;
            
            // إضافة التأثيرات الاحتفالية
            setTimeout(() => {
                showCelebrationEffects(percentage);
            }, 500);
            
            // إحصائيات
            showStatistics(totalTime, percentage);
            
            // تفاصيل النتائج
            showDetailedResults();
            
            // التوصيات
            showRecommendations(percentage);
        }

        // إضافة تأثيرات بصرية عند التحميل
        document.addEventListener('DOMContentLoaded', function() {
            // إضافة الأنماط المطلوبة للحركات
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fall {
                    to {
                        transform: translateY(100vh) rotate(360deg);
                        opacity: 0;
                    }
                }
                
                @keyframes explode {
                    0% { transform: scale(0); opacity: 1; }
                    50% { transform: scale(1.5); opacity: 0.8; }
                    100% { transform: scale(0); opacity: 0; }
                }
                
                @keyframes twinkle {
                    0%, 100% { opacity: 0.3; transform: scale(0.8); }
                    50% { opacity: 1; transform: scale(1.2); }
                }
                
                @keyframes float {
                    to {
                        transform: translateY(-100vh);
                        opacity: 0;
                    }
                }
                
                @keyframes sparkle {
                    0% { opacity: 0; transform: scale(0) rotate(0deg); }
                    50% { opacity: 1; transform: scale(1) rotate(180deg); }
                    100% { opacity: 0; transform: scale(0) rotate(360deg); }
                }
                
                @keyframes slideDown {
                    from {
                        transform: translateX(-50%) translateY(-100px);
                        opacity: 0;
                    }
                    to {
                        transform: translateX(-50%) translateY(0);
                        opacity: 1;
                    }
                }
                
                @keyframes slideUp {
                    from {
                        transform: translateX(-50%) translateY(0);
                        opacity: 1;
                    }
                    to {
                        transform: translateX(-50%) translateY(-100px);
                        opacity: 0;
                    }
                }
            `;
            document.head.appendChild(style);
            
            // تأثير تدريجي للعناصر
            const elements = document.querySelectorAll('.info-card, .btn, .author-section');
            elements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'all 0.5s ease';
                
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, index * 100);
            });
        });
    </script>
</body>
</html>
